
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://e-racingbergamo.github.io/documentation/codice/lezioni_di_c/funzioni/">
      
      
        <link rel="prev" href="../strutture_base/">
      
      
        <link rel="next" href="../puntatori/">
      
      
      <link rel="icon" href="../../../assets/images/simbolo_blu.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Funzioni - My Docs</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.0/dist/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#funzioni-e-modularita" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="My Docs" class="md-header__button md-logo" aria-label="My Docs" data-md-component="logo">
      
  <img src="../../../assets/images/simbolo_blu.ico" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            My Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Funzioni
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Passa al tema scuro"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Passa al tema scuro" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Passa al tema chiaro"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Passa al tema chiaro" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="My Docs" class="md-nav__button md-logo" aria-label="My Docs" data-md-component="logo">
      
  <img src="../../../assets/images/simbolo_blu.ico" alt="logo">

    </a>
    My Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Codice
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Codice
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Lezioni di C
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Lezioni di C
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sintassi_base_c/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sintassi di base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stdint/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Standard int
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visibilit%C3%A0_delle_variabili/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visibilità e durata delle variabili
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../strutture_base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Strutture dati di base
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Funzioni
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Funzioni
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dichiarazione-e-definizione" class="md-nav__link">
    <span class="md-ellipsis">
      Dichiarazione e definizione
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parametri-per-valore-e-per-riferimento" class="md-nav__link">
    <span class="md-ellipsis">
      Parametri per valore e per riferimento
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tipi-di-funzioni" class="md-nav__link">
    <span class="md-ellipsis">
      Tipi di funzioni
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modularita-con-file-c-e-h" class="md-nav__link">
    <span class="md-ellipsis">
      Modularità con file .c e .h
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#puntatori-a-funzioni" class="md-nav__link">
    <span class="md-ellipsis">
      Puntatori a funzioni
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#typedef-per-puntatori-a-funzioni" class="md-nav__link">
    <span class="md-ellipsis">
      Typedef per puntatori a funzioni
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lambda-in-c" class="md-nav__link">
    <span class="md-ellipsis">
      Lambda in C
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#funzioni-avanzate" class="md-nav__link">
    <span class="md-ellipsis">
      Funzioni avanzate
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../puntatori/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Puntatori
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../centralina/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Centralina
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dichiarazione-e-definizione" class="md-nav__link">
    <span class="md-ellipsis">
      Dichiarazione e definizione
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parametri-per-valore-e-per-riferimento" class="md-nav__link">
    <span class="md-ellipsis">
      Parametri per valore e per riferimento
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tipi-di-funzioni" class="md-nav__link">
    <span class="md-ellipsis">
      Tipi di funzioni
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modularita-con-file-c-e-h" class="md-nav__link">
    <span class="md-ellipsis">
      Modularità con file .c e .h
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#puntatori-a-funzioni" class="md-nav__link">
    <span class="md-ellipsis">
      Puntatori a funzioni
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#typedef-per-puntatori-a-funzioni" class="md-nav__link">
    <span class="md-ellipsis">
      Typedef per puntatori a funzioni
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lambda-in-c" class="md-nav__link">
    <span class="md-ellipsis">
      Lambda in C
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#funzioni-avanzate" class="md-nav__link">
    <span class="md-ellipsis">
      Funzioni avanzate
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="funzioni-e-modularita">Funzioni e modularità</h1>
<p>Le funzioni sono blocchi di codice riutilizzabili che eseguono un compito specifico. La loro corretta progettazione è fondamentale per la modularità di un progetto, soprattutto in ambienti embedded dove il firmware viene suddiviso in moduli separati e ben organizzati.</p>
<h3 id="dichiarazione-e-definizione">Dichiarazione e definizione</h3>
<p>Una funzione si dichiara indicando il <strong>tipo di ritorno</strong>, il <strong>nome</strong> e i <strong>parametri</strong>:</p>
<pre><code class="language-c">int somma(int a, int b) {
    return a + b;
}
</code></pre>
<p>Qui <code>somma</code> prende due interi e restituisce un intero.<br />
Il tipo di ritorno può essere qualsiasi tipo valido: <code>int</code>, <code>float</code>, <code>char</code>, <code>struct</code>, oppure <code>void</code> se non deve restituire nulla.</p>
<h3 id="parametri-per-valore-e-per-riferimento">Parametri per valore e per riferimento</h3>
<ul>
<li><strong>Per valore</strong>: viene passata una copia della variabile, modifiche dentro la funzione non influenzano l’originale.</li>
<li><strong>Per riferimento</strong>: si passa l’indirizzo della variabile tramite un puntatore, e quindi la funzione può modificare l’originale.</li>
</ul>
<pre><code class="language-c">void incrementa_valore(int x) {
    x++;
}

void incrementa_riferimento(int *x) {
    (*x)++;
}
</code></pre>
<p>In questo caso il simbolo <code>*</code> viene chiamato operatore di dereference, che consente di modificare direttamente il valore della variabile a partire dal suo puntatore. Se nel secondo caso si facesse <code>x++</code> si andrebbe ad incrementare il puntatore alla variabile, rischiando di andare oltre la sua area di memoria con operazioni successive e corrompere altre variabili o funzioni.</p>
<h3 id="tipi-di-funzioni">Tipi di funzioni</h3>
<ol>
<li><strong>Funzioni con ritorno e parametri</strong>
    <code>c
    int moltiplica(int a, int b) {
        return a * b;
    }</code></li>
<li><strong>Funzioni senza parametri</strong>
    <code>c
    int leggi_sensore(void) {
        return 42;
    }</code></li>
<li><strong>Funzioni senza ritorno (<code>void</code>)</strong>
    <code>c
    void stampa_valore(int v) {
        printf("%d\n", v);
    }</code></li>
<li><strong>Funzioni inline</strong><br />
    Suggeriscono al compilatore di espandere la funzione al posto della chiamata (ottimizzazione). In poche parole la funzione viene copiata al posto della chiamata. E' consigliabile usarlo solo con funzioni piccole, cioè che fanno una semplice operazione aritmetica o chiamata a funzione.
    <code>c
    inline int quadrato(int x) {
        return x * x;
    }</code></li>
<li><strong>Funzioni static</strong><br />
    Se dichiarate <code>static</code> a livello di file <code>.c</code>, la loro visibilità è limitata solo a quel file, impedendo che siano richiamabili da altri moduli.
    <code>c
    static void reset_interno(void) {
        // codice interno
    }</code></li>
</ol>
<p>E utile conoscere anche la combinazione di static e inline, che permette al compilatore di poter scegliere quando utilizzare inline o quando invece serve avere una definizione della funzione vera e propria.</p>
<h3 id="modularita-con-file-c-e-h">Modularità con file <code>.c</code> e <code>.h</code></h3>
<p>Per mantenere il codice ordinato:</p>
<ul>
<li>nel file <code>.c</code> si mettono le <strong>definizioni</strong> delle funzioni,</li>
<li>nel file <code>.h</code> si mettono i <strong>prototipi</strong> (cioè la firma senza corpo).</li>
</ul>
<p>Esempio:</p>
<p><strong>math_utils.h</strong></p>
<pre><code class="language-c">#ifndef MATH_UTILS_H
#define MATH_UTILS_H

int somma(int a, int b);
int moltiplica(int a, int b);

#endif
</code></pre>
<p><strong>math_utils.c</strong></p>
<pre><code class="language-c">#include &quot;math_utils.h&quot;

int somma(int a, int b) {
    return a + b;
}

int moltiplica(int a, int b) {
    return a * b;
}
</code></pre>
<p>Così gli altri moduli possono includere <code>math_utils.h</code> e usare le funzioni senza conoscere l’implementazione.</p>
<hr />
<h3 id="puntatori-a-funzioni">Puntatori a funzioni</h3>
<p>In C è possibile memorizzare l’indirizzo di una funzione in una variabile, e poi richiamarla attraverso questa.<br />
Questo meccanismo è molto utile per callback e per realizzare codice flessibile.</p>
<pre><code class="language-c">int somma(int a, int b) { return a + b; }
int moltiplica(int a, int b) { return a * b; }

int calcola(int (*operazione)(int, int), int x, int y) {
    return operazione(x, y);
}

int main(void) {
    int r1 = calcola(somma, 2, 3);
    int r2 = calcola(moltiplica, 2, 3);
}
</code></pre>
<hr />
<h3 id="typedef-per-puntatori-a-funzioni">Typedef per puntatori a funzioni</h3>
<p>Scrivere i prototipi di puntatori a funzioni può diventare complicato, per questo si usa <code>typedef</code>.</p>
<pre><code class="language-c">typedef int (*Operazione)(int, int);

int calcola(Operazione op, int x, int y) {
    return op(x, y);
}
</code></pre>
<p>Questo approccio è molto comune in embedded, ad esempio per definire callback da registrare in un driver.</p>
<hr />
<h3 id="lambda-in-c">Lambda in C</h3>
<p>Il C standard <strong>non supporta le lambda</strong> (funzioni anonime inline) come C++ o altri linguaggi.<br />
Alcuni compilatori (come GCC) offrono estensioni che permettono funzioni nidificate, ma non sono portabili e non sono consigliate in un progetto embedded.</p>
<p>Per simulare lambde, in C si usano:</p>
<ul>
<li>puntatori a funzioni,</li>
<li>funzioni statiche locali al file,</li>
<li>closure manuali con struct che raggruppano stato e puntatore a funzione.</li>
</ul>
<h3 id="funzioni-avanzate">Funzioni avanzate</h3>
<p><strong>Ricorsione</strong><br />
Una funzione ricorsiva è una funzione che chiama se stessa per risolvere un problema più grande suddividendolo in sottoproblemi più semplici. Un esempio classico è il calcolo del fattoriale:</p>
<pre><code class="language-c">int fattoriale(int n) {
    if (n &lt;= 1)
        return 1;
    else
        return n * fattoriale(n - 1);
}
</code></pre>
<p>In questo caso la funzione continua a richiamarsi fino a quando raggiunge la condizione base (<code>n &lt;= 1</code>). La ricorsione è potente, ma in ambiente embedded va usata con estrema cautela perché ogni chiamata aggiunge un nuovo frame nello stack. Poiché lo stack nei microcontrollori è tipicamente molto limitato, un uso eccessivo della ricorsione può portare a stack overflow e comportamenti imprevedibili.<br />
In sistemi a risorse limitate, è spesso preferibile convertire una ricorsione in un ciclo iterativo.</p>
<p><strong>Funzioni variadiche</strong><br />
Alcune funzioni in C possono accettare un numero variabile di argomenti. L’esempio più noto è <code>printf</code>. Per implementarle si utilizza la libreria <code>&lt;stdarg.h&gt;</code>, che fornisce i tipi e le macro necessarie per accedere agli argomenti aggiuntivi.</p>
<p>Esempio semplificato di funzione che calcola la media di un numero variabile di interi:</p>
<pre><code class="language-c">#include &lt;stdarg.h&gt;
#include &lt;stdio.h&gt;

double media(int count, ...) {
    va_list args;
    va_start(args, count);
    int somma = 0;

    for (int i = 0; i &lt; count; i++) {
        somma += va_arg(args, int);
    }

    va_end(args);
    return (double)somma / count;
}
</code></pre>
<p>L’uso di funzioni variadiche deve essere ponderato: gli argomenti non hanno un tipo esplicito e un errore nella gestione (ad esempio passare un tipo sbagliato) non viene rilevato dal compilatore.</p>
<hr />
<p><strong>Funzioni inline vs macro</strong><br />
Le macro (<code>#define</code>) permettono di definire frammenti di codice riutilizzabili che vengono sostituiti dal preprocessore. Ad esempio:</p>
<pre><code class="language-c">#define QUADRATO(x) ((x) * (x))
</code></pre>
<p>Il problema è che le macro non hanno controllo sui tipi e possono introdurre errori difficili da individuare (ad esempio <code>QUADRATO(a+b)</code> si espande in <code>((a+b)*(a+b))</code>, che può avere effetti collaterali inattesi se <code>x</code> è un’espressione con side-effect).</p>
<p>Le funzioni <code>inline</code> sono un’alternativa molto più sicura:</p>
<pre><code class="language-c">inline int quadrato(int x) {
    return x * x;
}
</code></pre>
<p>Il compilatore può sostituire la chiamata con il corpo della funzione (senza overhead di chiamata), mantenendo però il controllo sui tipi e la leggibilità. Per questo motivo, in C moderno si preferisce sempre l’uso di funzioni <code>inline</code> rispetto alle macro per operazioni semplici.</p>
<hr />
<p><strong>Uso di <code>const</code> nei parametri</strong><br />
La keyword <code>const</code> applicata ai parametri di funzione è fondamentale per chiarire le intenzioni e prevenire modifiche indesiderate.</p>
<p>Esempio senza <code>const</code>:</p>
<pre><code class="language-c">void stampa_stringa(char *str);
</code></pre>
<p>In questo caso non è chiaro se la funzione modifichi o meno il contenuto della stringa.</p>
<p>Con <code>const</code>:</p>
<pre><code class="language-c">void stampa_stringa(const char *str);
</code></pre>
<p>Ora il compilatore impedirà qualsiasi modifica al contenuto di <code>str</code> all’interno della funzione, e chi legge il codice capisce immediatamente che la funzione si limita a leggere la stringa senza alterarla.</p>
<p>L’uso di <code>const</code> è particolarmente importante in ambienti embedded, dove la protezione contro modifiche indesiderate alla memoria (ad esempio buffer condivisi o registri di periferiche mappati in memoria) può prevenire errori difficili da diagnosticare.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.15.0/dist/katex.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.15.0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>